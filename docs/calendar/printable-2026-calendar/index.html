<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Printable Calendar â€” A4, Any Year (2025/2026/2027+) | GoToolOnline</title>
<meta name="description" content="Free printable A4 calendar for any year (quick picks: 2025, 2026, 2027). Choose 12 pages (one month per A4) or 1 page (12 months). Week starts Sunday/Monday and optional ISO week numbers."/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- Canonical & Social -->

<meta property="og:type" content="website"/>
<meta property="og:title" content="Printable Calendar â€” A4, Any Year (2025/2026/2027+) | GoToolOnline"/>
<meta property="og:description" content="Generate a clean A4 printable calendar for any year. 12 pages (1 month/A4) or 1 page (12 months), Monday/Sunday start, ISO week numbers."/>
<meta property="og:url" content="https://gotoolonline.com/calendar/printable-2026-calendar/"/>
<meta name="twitter:card" content="summary"/>

<!-- Structured data: WebApplication -->
<script type="application/ld+json">
  {"@context":"https://schema.org","@type":"WebApplication","name":"Printable Calendar (A4)","url":"https://gotoolonline.com/calendar/printable-2026-calendar/","applicationCategory":"Utility","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"publisher":{"@type":"Organization","name":"GoToolOnline","url":"https://gotoolonline.com"}}
</script>
<!-- Structured data: FAQPage (enhances SERP) -->
<script type="application/ld+json">
  {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[
    {"@type":"Question","name":"Can I print the whole year on one A4 page?","acceptedAnswer":{"@type":"Answer","text":"Yes. Choose the '1 page â€” 12 months (3Ã—4)' layout to generate a compact 12-in-1 yearly calendar on a single A4 sheet."}},
    {"@type":"Question","name":"How do I show ISO week numbers?","acceptedAnswer":{"@type":"Answer","text":"Toggle the ISO week numbers option before generating. Week numbers are added as a left column on monthly pages."}},
    {"@type":"Question","name":"Can I start weeks on Monday?","acceptedAnswer":{"@type":"Answer","text":"Yes. Use the Week start setting to switch between Sunday and Monday."}}
  ]}
</script>
<!-- Optional: breadcrumb -->
<script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[
    {"@type":"ListItem","position":1,"name":"Home","item":"https://gotoolonline.com/"},
    {"@type":"ListItem","position":2,"name":"Calendars","item":"https://gotoolonline.com/#calendar"},
    {"@type":"ListItem","position":3,"name":"Printable Calendar (A4)","item":"https://gotoolonline.com/calendar/printable-2026-calendar/"}
  ]}
</script>

<style>
  :root { --bg:#0a0f1e; --card:#0f1830; --muted:#9fb0c3; --fg:#eaf3ff; --acc:#4fb3ff; --ink:#111317; }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg)}
  header{max-width:1200px;margin:24px auto 8px;display:flex;gap:14px;align-items:center;padding:0 18px}
  header a.logo{display:flex;gap:10px;align-items:center;text-decoration:none;color:var(--fg);font-weight:800;font-size:24px}
  header a.navbtn{margin-left:auto;padding:10px 14px;background:#0f1a2f;border:1px solid #24365b;border-radius:12px;color:#eaf3ff;text-decoration:none;font-size:16px}
  header a.navbtn:hover{border-color:#4fb3ff;box-shadow:0 0 0 3px rgba(79,179,255,.18)}
  #langBtn{margin-left:8px}
  .pill{padding:8px 12px;border:1px solid #24365b;background:#0f1a2f;border-radius:999px;color:var(--fg);text-decoration:none}
  .lang-panel{position:fixed; top:72px; right:18px; z-index:1200;background:#0f1830;border:1px solid #1a2843;border-radius:16px;padding:12px;display:none;width:min(420px,calc(100vw - 24px));box-shadow:0 20px 60px rgba(0,0,0,.45)}
  .lang-panel.open{display:block}
  .lang-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
  .lang-grid button{display:block;width:100%;text-align:center;padding:10px;border:1px solid #24365b;background:#0f1a2f;border-radius:12px;color:var(--fg);font-size:14px;cursor:pointer}
  .lang-grid button.active{border-color:#4fb3ff;box-shadow:0 0 0 3px rgba(79,179,255,.18)}

  main{max-width:1200px;margin:10px auto 72px;padding:0 18px}
  h1{font-size:34px;margin:10px 0 12px}
  p,label{font-size:18px;line-height:1.6}
  .muted{color:var(--muted)}
  .card{background:var(--card);border:1px solid #1a2843;border-radius:20px;padding:20px;margin:16px 0}
  input,select,button{padding:12px;border-radius:12px;border:1px solid #24365b;background:#0f1a2f;color:#eaf3ff;font-size:16px}
  button{cursor:pointer;background:linear-gradient(180deg,#2a78ff,#0050d4);border:none;font-weight:700;letter-spacing:.2px}
  button:hover{filter:brightness(1.06)}
  .toolbar{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .chip{padding:8px 12px;border:1px solid #24365b;background:#0f1a2f;border-radius:999px;cursor:pointer;font-size:16px}
  .chip:hover{border-color:#4fb3ff;box-shadow:0 0 0 3px rgba(79,179,255,.18)}
  .grid-preview{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
  .preview{background:#0f1830;border:1px solid #1a2843;border-radius:16px;padding:12px}
  .preview h3{margin:0 0 6px 0;font-size:18px}
  .mini{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;font-size:12px}
  .mini .dow{opacity:.7}
  .mini div{padding:6px 4px;text-align:center;border:1px solid #1a2843;border-radius:6px}
  .layoutRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .spacer{flex:1}
  .small{font-size:14px;color:#9fb0c3}

  /* PRINT LAYOUTS */
  @page { size: A4; margin: 12mm; }
  .print-wrap{background:white;color:var(--ink)}
  .page{page-break-after:always}
  .page:last-child{page-break-after:auto}
  .sheet{display:flex;flex-direction:column;gap:8mm}
  .sheet h2{margin:0;font-size:18pt;letter-spacing:.2pt}
  .cal{display:grid;grid-template-columns:repeat(7,1fr);gap:2mm}
  .cell{border:1px solid #444;padding:4mm;min-height:20mm}
  .dow-head{font-weight:700;background:#f0f0f0;text-align:center}
  .date{font-weight:700}
  .notes{margin-top:2mm;border-top:1px solid #ccc;padding-top:2mm;font-size:9pt;color:#333}

  /* 1-page (12 months) grid */
  .year12{display:grid;grid-template-columns:repeat(3,1fr);gap:6mm}
  .block{border:1px solid #333;border-radius:2mm;padding:4mm}
  .block h3{margin:0 0 3mm 0;font-size:12pt;text-align:center}
  .miniCal{display:grid;grid-template-columns:repeat(7,1fr);gap:1mm}
  .miniCal div{border:1px solid #ccc;text-align:center;font-size:8.5pt;padding:1.5mm;border-radius:1mm}
  .miniCal .dow{font-weight:700;background:#f5f5f5}

  @media print{
    body{background:#fff}
    header, .web-only{display:none !important}
    .print-wrap{display:block}
  }
</style>

  
  <link rel="alternate" hreflang="en" href="https://gotoolonline.com/calendar/printable-2026-calendar/"/>
  <link rel="alternate" hreflang="x-default" href="https://gotoolonline.com/calendar/printable-2026-calendar/"/>

<link rel="canonical" href="https://gotoolonline.com/calendar/printable-2026-calendar/">
</head>
<body>
<header>
  <a class="logo" data-home href="#"><span>ğŸ› ï¸</span><strong>GoToolOnline</strong></a>
  <a class="navbtn" data-home href="#" data-i18n="ui.back">â† Back to Home</a>
  <button id="langBtn" class="pill" aria-haspopup="dialog" aria-expanded="false" data-i18n="ui.lang">ğŸŒ Language</button>
  <div class="lang-panel" id="langPanel" role="dialog" aria-label="Select language">
    <div class="lang-grid" id="langGrid"></div>
  </div>
</header>

<main>
  <section class="card web-only">
    <h1 data-i18n="title">Printable Calendar (A4)</h1>
    <p class="muted" data-i18n="lede">
      Create a clean A4 printable calendar for any year. Pick year, layout, week start, and ISO week numbers, then print or save as PDF.
    </p>

    <div class="toolbar">
      <label data-i18n="form.year">Year <input id="year" type="number" min="1600" max="9999" style="width:120px" value="2026" aria-label="Year"/></label>
      <span class="chip" data-year="2025" role="button" aria-label="Set year 2025">2025</span>
      <span class="chip" data-year="2026" role="button" aria-label="Set year 2026">2026</span>
      <span class="chip" data-year="2027" role="button" aria-label="Set year 2027">2027</span>

      <div class="layoutRow">
        <label data-i18n="form.layout">Layout
          <select id="layout" aria-label="Layout">
            <option value="12pages" data-i18n="layout.monthly">12 pages â€” 1 month per A4</option>
            <option value="1page" data-i18n="layout.year1">1 page â€” 12 months (3Ã—4)</option>
          </select>
        </label>
        <label data-i18n="form.weekstart">Week start
          <select id="weekStart" aria-label="Week start">
            <option value="0" data-i18n="week.sun">Sunday</option>
            <option value="1" data-i18n="week.mon" selected>Monday</option>
          </select>
        </label>
        <label class="inline" data-i18n="form.iso">ISO week #
          <input id="weekNum" type="checkbox" aria-label="Show ISO week numbers"/>
        </label>
      </div>

      <span class="spacer"></span>
      <button id="genBtn" data-i18n="btn.generate">Generate</button>
      <button id="printBtn" title="Open browser print dialog" data-i18n="btn.print">Print / Save PDF</button>
    </div>

    <p class="small" style="margin-top:10px">
      <span data-i18n="related.title">Related:</span>
      <a href="/calendar/week-number-finder/">Week Number Finder</a> Â·
      <a href="/time/countdown-timer/">Countdown Timer</a> Â·
      <a href="/time/timezone-converter/">World Time (by Country)</a>
    </p>
  </section>

  <!-- Screen preview -->
  <section class="card web-only" id="previewCard">
    <h2 style="margin:0 0 10px 0;font-size:26px" data-i18n="preview.title">Screen Preview</h2>
    <div class="grid-preview" id="preview"></div>
    <div class="small" style="margin-top:8px" data-i18n="preview.note">Note: Screen preview is compact. Printed pages are A4 with larger boxes.</div>
  </section>

  <!-- Print DOM (hidden on screen, visible when printing) -->
  <div class="print-wrap" id="printRoot" style="display:none"></div>
</main>

<script>
  // ------- helpers & elements -------
  const $ = sel => document.querySelector(sel);
  const previewEl = $('#preview');
  const printRoot = $('#printRoot');
  const yearEl = $('#year');
  const layoutEl = $('#layout');
  const weekStartEl = $('#weekStart');
  const weekNumEl = $('#weekNum');

  // i18n calendar strings (months/days) per language
  const CAL = {
    en: {
      months: ['January','February','March','April','May','June','July','August','September','October','November','December'],
      dowSun: ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],
      wk: 'Wk',
      wsNames: {0:'Sunday',1:'Monday'}
    },
    zh: {
      months: ['ä¸€æœˆ','äºŒæœˆ','ä¸‰æœˆ','å››æœˆ','äº”æœˆ','å…­æœˆ','ä¸ƒæœˆ','å…«æœˆ','ä¹æœˆ','åæœˆ','åä¸€æœˆ','åäºŒæœˆ'],
      dowSun: ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'],
      wk: 'å‘¨',
      wsNames: {0:'å‘¨æ—¥',1:'å‘¨ä¸€'}
    },
    ph: {
      months: ['Ene','Peb','Mar','Abr','May','Hun','Hul','Ago','Set','Okt','Nob','Dis'],
      dowSun: ['Lin','Lun','Mar','Miy','Huw','Biy','Sab'],
      wk: 'Linggo',
      wsNames: {0:'Linggo',1:'Lunes'}
    },
    id: {
      months: ['Jan','Feb','Mar','Apr','Mei','Jun','Jul','Agt','Sep','Okt','Nov','Des'],
      dowSun: ['Min','Sen','Sel','Rab','Kam','Jum','Sab'],
      wk: 'Pekan',
      wsNames: {0:'Minggu',1:'Senin'}
    },
    vi: {
      months: ['ThÃ¡ng 1','ThÃ¡ng 2','ThÃ¡ng 3','ThÃ¡ng 4','ThÃ¡ng 5','ThÃ¡ng 6','ThÃ¡ng 7','ThÃ¡ng 8','ThÃ¡ng 9','ThÃ¡ng 10','ThÃ¡ng 11','ThÃ¡ng 12'],
      dowSun: ['CN','T2','T3','T4','T5','T6','T7'],
      wk: 'Tuáº§n',
      wsNames: {0:'Chá»§ nháº­t',1:'Thá»© hai'}
    },
    bn: {
      months: ['à¦œà¦¾à¦¨à§','à¦«à§‡à¦¬','à¦®à¦¾à¦°à§à¦š','à¦à¦ªà§à¦°à¦¿','à¦®à§‡','à¦œà§à¦¨','à¦œà§à¦²','à¦†à¦—','à¦¸à§‡à¦ªà§à¦Ÿà§‡','à¦…à¦•à§à¦Ÿà§‹','à¦¨à¦­à§‡','à¦¡à¦¿à¦¸à§‡'],
      dowSun: ['à¦°à¦¬à¦¿','à¦¸à§‹à¦®','à¦®à¦™à§à¦—à¦²','à¦¬à§à¦§','à¦¬à§ƒà¦¹','à¦¶à§à¦•à§à¦°','à¦¶à¦¨à¦¿'],
      wk: 'à¦¸à¦ªà§à¦¤à¦¾à¦¹',
      wsNames: {0:'à¦°à¦¬à¦¿à¦¬à¦¾à¦°',1:'à¦¸à§‹à¦®à¦¬à¦¾à¦°'}
    },
    ng: { // English (NG)
      months: ['January','February','March','April','May','June','July','August','September','October','November','December'],
      dowSun: ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],
      wk: 'Wk',
      wsNames: {0:'Sunday',1:'Monday'}
    },
    sw: {
      months: ['Jan','Feb','Mac','Apr','Mei','Jun','Jul','Ago','Sep','Okt','Nov','Des'],
      dowSun: ['Jum','Jtt','Jnn','Jtn','Alh','Ijm','Jms'],
      wk: 'Wiki',
      wsNames: {0:'Jumapili',1:'Jumatatu'}
    },
    ar: {
      months: ['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ','ÙŠÙˆÙ„ÙŠÙˆ','Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±'],
      dowSun: ['Ø£Ø­Ø¯','Ø§Ø«Ù†','Ø«Ù„Ø§Ø«','Ø£Ø±Ø¨Ø¹','Ø®Ù…Ø³','Ø¬Ù…Ø¹','Ø³Ø¨Øª'],
      wk: 'Ø£Ø³Ø¨ÙˆØ¹',
      wsNames: {0:'Ø§Ù„Ø£Ø­Ø¯',1:'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†'}
    }
  };

  // ISO week number (Mon-based)
  function isoWeekNumber(date){
    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    const dayNum = (d.getUTCDay() + 6) % 7; // Mon=0..Sun=6
    d.setUTCDate(d.getUTCDate() - dayNum + 3);
    const firstThu = new Date(Date.UTC(d.getUTCFullYear(),0,4));
    const diff = d - firstThu;
    return 1 + Math.round(diff / (7*24*3600*1000));
  }

  function monthMatrix(year, month, weekStart){
    // returns array of weeks; each week is [{y,m,d,otherMonth}]
    const first = new Date(year, month, 1);
    const last = new Date(year, month+1, 0);
    const startDow = first.getDay(); // 0 Sun - 6 Sat
    const ws = parseInt(weekStart,10); // 0 Sun / 1 Mon
    const shift = (startDow - ws + 7) % 7;
    const daysInMonth = last.getDate();

    const weeks = [];
    let day = 1 - shift;
    while (day <= daysInMonth){
      const wk = [];
      for (let i=0;i<7;i++){
        const cur = new Date(year, month, day);
        wk.push({ y:cur.getFullYear(), m:cur.getMonth(), d:cur.getDate(), otherMonth: cur.getMonth()!==month });
        day++;
      }
      weeks.push(wk);
    }
    return weeks;
  }

  function dowByStart(lang, ws){
    const base = (CAL[lang]||CAL.en).dowSun.slice(); // Sunday first
    if (parseInt(ws,10)===1){ // Monday first
      const first = base.shift(); base.push(first);
    }
    return base;
  }

  // ------- preview render -------
  function renderPreview(year, weekStart, showWeek, lang){
    previewEl.innerHTML = '';
    const months = (CAL[lang]||CAL.en).months;
    const DOW = dowByStart(lang, weekStart);
    const wkLabel = (CAL[lang]||CAL.en).wk;

    for(let m=0;m<12;m++){
      const wrap = document.createElement('div');
      wrap.className = 'preview';
      wrap.innerHTML = `<h3>${months[m]} ${year}</h3>`;
      const grid = document.createElement('div');
      grid.className = 'mini';

      if (showWeek){
        const w = document.createElement('div');
        w.className = 'dow';
        w.textContent = wkLabel;
        grid.appendChild(w);
      }
      DOW.forEach(d=>{
        const el = document.createElement('div');
        el.className = 'dow';
        el.textContent = d;
        grid.appendChild(el);
      });

      const weeks = monthMatrix(year, m, weekStart);
      weeks.forEach(week=>{
        if (showWeek){
          const anyInMonth = week.find(c=>!c.otherMonth);
          const wknum = isoWeekNumber(new Date(anyInMonth.y, anyInMonth.m, anyInMonth.d));
          const wk = document.createElement('div');
          wk.textContent = wknum;
          grid.appendChild(wk);
        }
        week.forEach(cell=>{
          const el = document.createElement('div');
          el.textContent = cell.d;
          if (cell.otherMonth){ el.style.opacity = .35; }
          grid.appendChild(el);
        });
      });

      wrap.appendChild(grid);
      previewEl.appendChild(wrap);
    }
  }

  // ------- print render -------
  function renderPrint(year, layout, weekStart, showWeek, lang, dict){
    printRoot.innerHTML = '';
    printRoot.style.display = 'none';

    if (layout === '12pages'){
      for(let m=0;m<12;m++){
        printRoot.appendChild(renderMonthPage(year, m, weekStart, showWeek, lang, dict));
      }
    } else {
      printRoot.appendChild(renderYearOnePage(year, weekStart, showWeek, lang, dict));
    }
  }

  function renderMonthPage(year, month, weekStart, showWeek, lang, dict){
    const months = (CAL[lang]||CAL.en).months;
    const DOW = dowByStart(lang, weekStart);
    const wkLabel = (CAL[lang]||CAL.en).wk;

    const page = document.createElement('div');
    page.className = 'page';
    const wsName = (CAL[lang]||CAL.en).wsNames[parseInt(weekStart,10)];
    const noteIso = showWeek ? (dict.notes.showIso || 'ISO week numbers shown') : '';
    const noteTpl = dict.notes.monthly || 'Notes: Printed from GoToolOnline â€” Week start: {ws}{iso}.';
    const noteText = noteTpl.replace('{ws}', wsName).replace('{iso}', noteIso? (', ' + noteIso) : '');

    page.innerHTML = `
      <div class="sheet">
        <h2>${months[month]} ${year} Â· GoToolOnline.com</h2>
        <div class="cal"></div>
        <div class="notes">${noteText}</div>
      </div>
    `;
    const cal = page.querySelector('.cal');

    if (showWeek){
      const head = document.createElement('div');
      head.className = 'cell dow-head';
      head.textContent = wkLabel;
      cal.appendChild(head);
    }
    DOW.forEach(d=>{
      const h = document.createElement('div');
      h.className = 'cell dow-head';
      h.textContent = d;
      cal.appendChild(h);
    });

    const weeks = monthMatrix(year, month, weekStart);
    weeks.forEach(week=>{
      if (showWeek){
        const anyInMonth = week.find(c=>!c.otherMonth) || week[0];
        const wknum = isoWeekNumber(new Date(anyInMonth.y, anyInMonth.m, anyInMonth.d));
        const wcel = document.createElement('div');
        wcel.className = 'cell';
        wcel.innerHTML = `<div class="date">${wknum}</div>`;
        cal.appendChild(wcel);
      }
      week.forEach(cell=>{
        const el = document.createElement('div');
        el.className = 'cell';
        if (cell.otherMonth) el.style.opacity = .35;
        el.innerHTML = `<div class="date">${cell.d}</div>`;
        cal.appendChild(el);
      });
    });

    return page;
  }

  function renderYearOnePage(year, weekStart, showWeek, lang, dict){
    const months = (CAL[lang]||CAL.en).months;
    const DOW = dowByStart(lang, weekStart);
    const page = document.createElement('div');
    page.className = 'page';
    const wsName = (CAL[lang]||CAL.en).wsNames[parseInt(weekStart,10)];
    const noteIso = showWeek ? (dict.notes.showIsoShort || 'ISO week numbers (row header omitted)') : '';
    const noteTpl = dict.notes.yearly || 'Notes: Printed from GoToolOnline â€” Week start: {ws}{iso}.';
    const noteText = noteTpl.replace('{ws}', wsName).replace('{iso}', noteIso? (', ' + noteIso) : '');

    page.innerHTML = `
      <div class="sheet">
        <h2>${year} Â· ${dict.yearAtGlance || 'Year-at-a-Glance'} Â· GoToolOnline.com</h2>
        <div class="year12"></div>
        <div class="notes">${noteText}</div>
      </div>
    `;
    const wrap = page.querySelector('.year12');

    for(let m=0;m<12;m++){
      const block = document.createElement('div');
      block.className = 'block';
      block.innerHTML = `<h3>${months[m]}</h3>`;
      const cal = document.createElement('div');
      cal.className = 'miniCal';

      DOW.forEach(d=>{
        const h = document.createElement('div');
        h.className = 'dow';
        h.textContent = d;
        cal.appendChild(h);
      });

      const weeks = monthMatrix(year, m, weekStart);
      weeks.forEach(week=>{
        week.forEach(cell=>{
          const el = document.createElement('div');
          el.textContent = cell.d;
          if (cell.otherMonth) el.style.opacity = .35;
          cal.appendChild(el);
        });
      });

      block.appendChild(cal);
      wrap.appendChild(block);
    }
    return page;
  }

  // ------- i18n texts -------
  const EN = {
    meta:{title:"Printable Calendar â€” A4, Any Year (2025/2026/2027+) | GoToolOnline",
          desc:"Free printable A4 calendar for any year (quick picks: 2025, 2026, 2027). Choose 12 pages (one month per A4) or 1 page (12 months). Week starts Sunday/Monday and optional ISO week numbers."},
    ui:{back:"â† Back to Home", lang:"Language"},
    title:"Printable Calendar (A4)",
    lede:"Create a clean A4 printable calendar for any year. Pick year, layout, week start, and ISO week numbers, then print or save as PDF.",
    form:{year:"Year", layout:"Layout", weekstart:"Week start", iso:"ISO week #"},
    layout:{monthly:"12 pages â€” 1 month per A4", year1:"1 page â€” 12 months (3Ã—4)"},
    week:{sun:"Sunday", mon:"Monday"},
    btn:{generate:"Generate", print:"Print / Save PDF"},
    preview:{title:"Screen Preview", note:"Note: Screen preview is compact. Printed pages are A4 with larger boxes."},
    related:{title:"Related:"},
    notes:{monthly:"Notes: Printed from GoToolOnline â€” Week start: {ws}{iso}.",
           yearly:"Notes: Printed from GoToolOnline â€” Week start: {ws}{iso}.",
           showIso:"ISO week numbers shown",
           showIsoShort:"ISO week numbers shown (row header omitted in 12-in-1 layout)"},
    yearAtGlance:"Year-at-a-Glance"
  };

  const ZH = {
    meta:{title:"å¯æ‰“å°æ—¥å†ï¼ˆA4ï¼‰â€” ä»»æ„å¹´ä»½ | GoToolOnline",
          desc:"ä»»æ„å¹´ä»½ A4 å¯æ‰“å°æ—¥å†ï¼ˆå¿«é€Ÿï¼š2025/2026/2027ï¼‰ã€‚æ”¯æŒ 12 é¡µï¼ˆæ¯é¡µ 1 ä¸ªæœˆï¼‰æˆ– 1 é¡µï¼ˆ12 ä¸ªæœˆï¼‰ï¼Œå‘¨èµ·å§‹å‘¨æ—¥/å‘¨ä¸€ï¼Œå¯é€‰ ISO å‘¨æ•°ã€‚"},
    ui:{back:"â† è¿”å›é¦–é¡µ", lang:"è¯­è¨€"},
    title:"å¯æ‰“å°æ—¥å†ï¼ˆA4ï¼‰",
    lede:"ç”Ÿæˆä»»æ„å¹´ä»½çš„ç®€æ´ A4 å¯æ‰“å°æ—¥å†ï¼šé€‰æ‹©å¹´ä»½ã€ç‰ˆå¼ã€å‘¨èµ·å§‹ã€ISO å‘¨æ•°ï¼Œç„¶åæ‰“å°æˆ–å¦å­˜ä¸º PDFã€‚",
    form:{year:"å¹´ä»½", layout:"ç‰ˆå¼", weekstart:"å‘¨èµ·å§‹", iso:"ISO å‘¨æ•°"},
    layout:{monthly:"12 é¡µ â€” æ¯é¡µ 1 ä¸ªæœˆï¼ˆA4ï¼‰", year1:"1 é¡µ â€” 12 ä¸ªæœˆï¼ˆ3Ã—4ï¼‰"},
    week:{sun:"å‘¨æ—¥", mon:"å‘¨ä¸€"},
    btn:{generate:"ç”Ÿæˆ", print:"æ‰“å° / ä¿å­˜ PDF"},
    preview:{title:"å±å¹•é¢„è§ˆ", note:"æç¤ºï¼šå±å¹•é¢„è§ˆä¸ºå‹ç¼©å¸ƒå±€ï¼Œæ‰“å°ä¸º A4 å¤§æ–¹æ ¼ã€‚"},
    related:{title:"ç›¸å…³ï¼š"},
    notes:{monthly:"å¤‡æ³¨ï¼šæ¥è‡ª GoToolOnline â€” å‘¨èµ·å§‹ï¼š{ws}{iso}ã€‚", yearly:"å¤‡æ³¨ï¼šæ¥è‡ª GoToolOnline â€” å‘¨èµ·å§‹ï¼š{ws}{iso}ã€‚", showIso:"æ˜¾ç¤º ISO å‘¨æ•°", showIsoShort:"æ˜¾ç¤º ISO å‘¨æ•°ï¼ˆ12 åˆ 1 çœç•¥è¡Œå¤´ï¼‰"},
    yearAtGlance:"å…¨å¹´æ¦‚è§ˆ"
  };

  const PH = {
    ui:{back:"â† Bumalik sa Home", lang:"Wika"},
    title:"Napi-print na Kalendaryo (A4)",
    lede:"Gumawa ng malinis na A4 na kalendaryo para sa anumang taon. Piliin ang taon, layout, simula ng linggo, at ISO week numbers; i-print o i-save bilang PDF.",
    form:{year:"Taon", layout:"Layout", weekstart:"Simula ng linggo", iso:"ISO week #"},
    layout:{monthly:"12 pahina â€” 1 buwan / A4", year1:"1 pahina â€” 12 buwan (3Ã—4)"},
    week:{sun:"Linggo", mon:"Lunes"},
    btn:{generate:"Gumawa", print:"I-print / I-save PDF"},
    preview:{title:"Preview sa Screen", note:"Tandaan: Mas siksik ang preview; naka-A4 ang naka-print na pahina."},
    related:{title:"Kaugnay:"},
    notes:{monthly:"Tala: Ipinrint mula GoToolOnline â€” Simula ng linggo: {ws}{iso}.", yearly:"Tala: Ipinrint mula GoToolOnline â€” Simula ng linggo: {ws}{iso}.", showIso:"May ISO week numbers", showIsoShort:"May ISO week numbers (walang row header sa 12-in-1)"},
    yearAtGlance:"Buong Taon sa Isang Sulyap"
  };

  const ID = {
    ui:{back:"â† Kembali ke Beranda", lang:"Bahasa"},
    title:"Kalender Cetak (A4)",
    lede:"Buat kalender A4 untuk tahun apa pun: pilih tahun, tata letak, awal pekan, dan nomor pekan ISO; lalu cetak atau simpan PDF.",
    form:{year:"Tahun", layout:"Tata letak", weekstart:"Awal pekan", iso:"ISO week #"},
    layout:{monthly:"12 halaman â€” 1 bulan per A4", year1:"1 halaman â€” 12 bulan (3Ã—4)"},
    week:{sun:"Minggu", mon:"Senin"},
    btn:{generate:"Buat", print:"Cetak / Simpan PDF"},
    preview:{title:"Pratinjau Layar", note:"Catatan: Pratinjau ringkas; halaman cetak A4 dengan kotak lebih besar."},
    related:{title:"Terkait:"},
    notes:{monthly:"Catatan: Dicetak dari GoToolOnline â€” Awal pekan: {ws}{iso}.", yearly:"Catatan: Dicetak dari GoToolOnline â€” Awal pekan: {ws}{iso}.", showIso:"Menampilkan nomor pekan ISO", showIsoShort:"Nomor pekan ISO (tanpa header baris di 12-dalam-1)"},
    yearAtGlance:"Setahun Sekilas"
  };

  const VI = {
    ui:{back:"â† Vá» trang chá»§", lang:"NgÃ´n ngá»¯"},
    title:"Lá»‹ch in (A4)",
    lede:"Táº¡o lá»‹ch A4 cho báº¥t ká»³ nÄƒm nÃ o: chá»n nÄƒm, bá»‘ cá»¥c, ngÃ y báº¯t Ä‘áº§u tuáº§n, sá»‘ tuáº§n ISO; rá»“i in hoáº·c lÆ°u PDF.",
    form:{year:"NÄƒm", layout:"Bá»‘ cá»¥c", weekstart:"Báº¯t Ä‘áº§u tuáº§n", iso:"Sá»‘ tuáº§n ISO"},
    layout:{monthly:"12 trang â€” 1 thÃ¡ng/A4", year1:"1 trang â€” 12 thÃ¡ng (3Ã—4)"},
    week:{sun:"Chá»§ nháº­t", mon:"Thá»© hai"},
    btn:{generate:"Táº¡o", print:"In / LÆ°u PDF"},
    preview:{title:"Xem trÆ°á»›c", note:"LÆ°u Ã½: Xem trÆ°á»›c dáº¡ng cÃ´ Ä‘á»ng; khi in lÃ  A4 Ã´ lá»›n."},
    related:{title:"LiÃªn quan:"},
    notes:{monthly:"Ghi chÃº: In tá»« GoToolOnline â€” Báº¯t Ä‘áº§u tuáº§n: {ws}{iso}.", yearly:"Ghi chÃº: In tá»« GoToolOnline â€” Báº¯t Ä‘áº§u tuáº§n: {ws}{iso}.", showIso:"Hiá»‡n sá»‘ tuáº§n ISO", showIsoShort:"Hiá»‡n sá»‘ tuáº§n ISO (bá» tiÃªu Ä‘á» hÃ ng á»Ÿ dáº¡ng 12-trong-1)"},
    yearAtGlance:"Tá»•ng quan cáº£ nÄƒm"
  };

  const BN = {
    ui:{back:"â† à¦¹à§‹à¦®à§‡ à¦«à¦¿à¦°à§‡ à¦¯à¦¾à¦¨", lang:"à¦­à¦¾à¦·à¦¾"},
    title:"à¦ªà§à¦°à¦¿à¦¨à§à¦Ÿà§‡à¦¬à¦² à¦•à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¡à¦¾à¦° (A4)",
    lede:"à¦¯à§‡ à¦•à§‹à¦¨à¦“ à¦¬à¦›à¦°à§‡à¦° à¦œà¦¨à§à¦¯ A4 à¦•à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¡à¦¾à¦° à¦¬à¦¾à¦¨à¦¾à¦¨: à¦¬à¦›à¦°, à¦²à§‡-à¦†à¦‰à¦Ÿ, à¦¸à¦ªà§à¦¤à¦¾à¦¹ à¦¶à§à¦°à§à¦° à¦¦à¦¿à¦¨, ISO à¦¸à¦ªà§à¦¤à¦¾à¦¹ à¦¸à¦‚à¦–à§à¦¯à¦¾ à¦¬à§‡à¦›à§‡ à¦¨à¦¿à¦¨; à¦¤à¦¾à¦°à¦ªà¦° à¦ªà§à¦°à¦¿à¦¨à§à¦Ÿ/PDFà¥¤",
    form:{year:"à¦¬à¦›à¦°", layout:"à¦²à§‡-à¦†à¦‰à¦Ÿ", weekstart:"à¦¸à¦ªà§à¦¤à¦¾à¦¹ à¦¶à§à¦°à§", iso:"ISO week #"},
    layout:{monthly:"à§§à§¨ à¦ªà§ƒà¦·à§à¦ à¦¾ â€” à¦ªà§à¦°à¦¤à¦¿ A4 à¦ à§§ à¦®à¦¾à¦¸", year1:"à§§ à¦ªà§ƒà¦·à§à¦ à¦¾ â€” à§§à§¨ à¦®à¦¾à¦¸ (3Ã—4)"},
    week:{sun:"à¦°à¦¬à¦¿à¦¬à¦¾à¦°", mon:"à¦¸à§‹à¦®à¦¬à¦¾à¦°"},
    btn:{generate:"à¦œà§‡à¦¨à¦¾à¦°à§‡à¦Ÿ", print:"à¦ªà§à¦°à¦¿à¦¨à§à¦Ÿ / PDF"},
    preview:{title:"à¦¸à§à¦•à§à¦°à¦¿à¦¨ à¦ªà§à¦°à¦¿à¦­à¦¿à¦‰", note:"à¦¨à§‹à¦Ÿ: à¦ªà§à¦°à¦¿à¦­à¦¿à¦‰ à¦˜à¦¨; à¦ªà§à¦°à¦¿à¦¨à§à¦Ÿà§‡à¦¡ à¦ªà§‡à¦œ A4 à¦¬à¦¡à¦¼ à¦¬à¦¾à¦•à§à¦¸ à¦¸à¦¹à¥¤"},
    related:{title:"à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤:"},
    notes:{monthly:"à¦Ÿà§€à¦•à¦¾: GoToolOnline à¦¥à§‡à¦•à§‡ à¦ªà§à¦°à¦¿à¦¨à§à¦Ÿ â€” à¦¸à¦ªà§à¦¤à¦¾à¦¹ à¦¶à§à¦°à§: {ws}{iso}.", yearly:"à¦Ÿà§€à¦•à¦¾: GoToolOnline à¦¥à§‡à¦•à§‡ à¦ªà§à¦°à¦¿à¦¨à§à¦Ÿ â€” à¦¸à¦ªà§à¦¤à¦¾à¦¹ à¦¶à§à¦°à§: {ws}{iso}.", showIso:"ISO à¦¸à¦ªà§à¦¤à¦¾à¦¹ à¦¸à¦‚à¦–à§à¦¯à¦¾ à¦¦à§‡à¦–à¦¾à¦¨à§‹", showIsoShort:"ISO à¦¸à¦ªà§à¦¤à¦¾à¦¹ à¦¸à¦‚à¦–à§à¦¯à¦¾ (12-in-1 à¦ à¦¸à¦¾à¦°à¦¿ à¦¹à§‡à¦¡à¦¾à¦° à¦¨à§‡à¦‡)"},
    yearAtGlance:"à¦ªà§à¦°à§‹ à¦¬à¦›à¦° à¦à¦• à¦¨à¦œà¦°à§‡"
  };

  const NG = { // English (NG)
    ui:{back:"â† Back to Home", lang:"Language"},
    title: EN.title, lede: EN.lede, form: EN.form, layout: EN.layout, week: EN.week,
    btn: EN.btn, preview: EN.preview, related: EN.related, notes: EN.notes, yearAtGlance: EN.yearAtGlance
  };

  const SW = {
    ui:{back:"â† Rudi nyumbani", lang:"Lugha"},
    title:"Kalenda ya Kuchapishwa (A4)",
    lede:"Tengeneza kalenda ya A4 kwa mwaka wowote: chagua mwaka, mpangilio, mwanzo wa wiki, na nambari za wiki za ISO; kisha chapa au hifadhi PDF.",
    form:{year:"Mwaka", layout:"Mpangilio", weekstart:"Mwanzo wa wiki", iso:"Namba za wiki za ISO"},
    layout:{monthly:"Kurasa 12 â€” mwezi 1 kwa A4", year1:"Ukurasa 1 â€” miezi 12 (3Ã—4)"},
    week:{sun:"Jumapili", mon:"Jumatatu"},
    btn:{generate:"Tengeneza", print:"Chapisha / Hifadhi PDF"},
    preview:{title:"Onyesho la Skrini", note:"Tanbihi: Onyesho la skrini ni fupi; kurasa zilizochapishwa ni A4 zenye visanduku vikubwa."},
    related:{title:"Zinazohusiana:"},
    notes:{monthly:"Maelezo: Imechapishwa kutoka GoToolOnline â€” Mwanzo wa wiki: {ws}{iso}.", yearly:"Maelezo: Imechapishwa kutoka GoToolOnline â€” Mwanzo wa wiki: {ws}{iso}.", showIso:"Nambari za wiki za ISO zinaonyeshwa", showIsoShort:"Nambari za wiki za ISO (kichwa cha safu kimeondolewa kwa 12-kwa-1)"},
    yearAtGlance:"Mwaka kwa Mtazamo"
  };

  const AR = {
    meta:{title:"ØªÙ‚ÙˆÙŠÙ… Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© (A4) â€” Ù„Ø£ÙŠ Ø³Ù†Ø© | GoToolOnline",
          desc:"Ø£Ù†Ø´Ø¦ ØªÙ‚ÙˆÙŠÙ… A4 Ù„Ø£ÙŠ Ø³Ù†Ø©: 12 ØµÙØ­Ø© (Ø´Ù‡Ø±/ØµÙØ­Ø©) Ø£Ùˆ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© (12 Ø´Ù‡Ø±Ù‹Ø§)ØŒ Ø¨Ø¯Ø¡ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£Ø­Ø¯/Ø§Ù„Ø§Ø«Ù†ÙŠÙ†ØŒ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¥Ø¸Ù‡Ø§Ø± Ø£Ø³Ø§Ø¨ÙŠØ¹ ISO."},
    ui:{back:"â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", lang:"Ø§Ù„Ù„ØºØ©"},
    title:"ØªÙ‚ÙˆÙŠÙ… Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© (A4)",
    lede:"Ø£Ù†Ø´Ø¦ ØªÙ‚ÙˆÙŠÙ… A4 Ù†Ø¸ÙŠÙÙ‹Ø§ Ù„Ø£ÙŠ Ø³Ù†Ø©. Ø§Ø®ØªØ± Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„ØªØ®Ø·ÙŠØ· ÙˆØ¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ£Ø³Ø§Ø¨ÙŠØ¹ ISOØŒ Ø«Ù… Ø§Ø·Ø¨Ø¹ Ø£Ùˆ Ø§Ø­ÙØ¸ ÙƒÙ…Ù„Ù PDF.",
    form:{year:"Ø§Ù„Ø³Ù†Ø©", layout:"Ø§Ù„ØªØ®Ø·ÙŠØ·", weekstart:"Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", iso:"Ø£Ø³Ø§Ø¨ÙŠØ¹ ISO"},
    layout:{monthly:"12 ØµÙØ­Ø© â€” Ø´Ù‡Ø± Ù„ÙƒÙ„ A4", year1:"ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© â€” 12 Ø´Ù‡Ø±Ù‹Ø§ (3Ã—4)"},
    week:{sun:"Ø§Ù„Ø£Ø­Ø¯", mon:"Ø§Ù„Ø§Ø«Ù†ÙŠÙ†"},
    btn:{generate:"Ø¥Ù†Ø´Ø§Ø¡", print:"Ø·Ø¨Ø§Ø¹Ø© / Ø­ÙØ¸ PDF"},
    preview:{title:"Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©", note:"Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø¶ØºÙˆØ·Ø©Ø› Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø¹Ù„Ù‰ A4 Ø¨Ù…Ø±Ø¨Ø¹Ø§Øª Ø£ÙƒØ¨Ø±."},
    related:{title:"Ø±ÙˆØ§Ø¨Ø· Ø°Ø§Øª ØµÙ„Ø©:"},
    notes:{monthly:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ØªÙ… Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ù…Ù† GoToolOnline â€” Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹: {ws}{iso}.", yearly:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ØªÙ… Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ù…Ù† GoToolOnline â€” Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹: {ws}{iso}.", showIso:"Ø¹Ø±Ø¶ Ø£Ø±Ù‚Ø§Ù… Ø£Ø³Ø§Ø¨ÙŠØ¹ ISO", showIsoShort:"Ø¹Ø±Ø¶ Ø£Ø±Ù‚Ø§Ù… Ø£Ø³Ø§Ø¨ÙŠØ¹ ISO (Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù† ØµÙ ÙÙŠ ØªØ®Ø·ÙŠØ· 12-ÙÙŠ-1)"},
    yearAtGlance:"Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ù„Ù„Ø³Ù†Ø©"
  };

  const MAP = {en:EN, zh:ZH, ph:PH, id:ID, vi:VI, bn:BN, ng:NG, sw:SW, ar:AR};

  // ------- i18n helpers -------
  function getCookie(name){ return ('; '+document.cookie).split('; '+name+'=').pop().split(';')[0] || ''; }
  function setCookie(name,val){ document.cookie = name+'='+val+';path=/;max-age=31536000'; }
  function get(obj, path){ return String(path).split('.').reduce((o,k)=> (o && (k in o))? o[k] : undefined, obj); }
  function merge(base, over){ const out={...base}; if(!over) return out; for(const k in over){ if(typeof over[k]==='object' && !Array.isArray(over[k])) out[k]=merge(base[k]||{},over[k]); else out[k]=over[k]; } return out; }

  const LANGS = ['en','zh','ph','id','vi','bn','ng','sw','ar'];
  const NAMES = {en:'English', zh:'ç®€ä½“ä¸­æ–‡', ph:'Tagalog', id:'Bahasa Indonesia', vi:'Tiáº¿ng Viá»‡t', bn:'à¦¬à¦¾à¦‚à¦²à¦¾', ng:'English (NG)', sw:'Kiswahili', ar:'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'};

  function pickLang(){
    const url = new URL(location.href);
    const q = (url.searchParams.get('lang')||'').toLowerCase();
    const c = (getCookie('lang')||'').toLowerCase();
    const nav = (navigator.language||'en').toLowerCase();
    const MAPG = {en:'en', tl:'ph', fil:'ph', id:'id', vi:'vi', bn:'bn', sw:'sw', ar:'ar', zh:'zh', 'zh-cn':'zh', 'zh-hans':'zh'};
    let lang='en';
    if (q && LANGS.includes(q)) lang=q;
    else if (c && LANGS.includes(c)) lang=c;
    else lang = MAPG[nav] || MAPG[nav.split('-')[0]] || 'en';
    setCookie('lang', lang);
    document.documentElement.lang = (lang==='ph'?'tl':(lang==='ng'?'en':lang));
    document.documentElement.dir = (lang==='ar'?'rtl':'ltr');
    return lang;
  }

  function applyI18N(D){
    // meta
    if (get(D,'meta.title')) document.title = get(D,'meta.title');
    const desc = document.querySelector('meta[name="description"]');
    if (desc && get(D,'meta.desc')) desc.setAttribute('content', get(D,'meta.desc'));

    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      const val = get(D, key);
      if (val == null) return;
      if (/<[a-z][\s\S]*>/i.test(val)) el.innerHTML = val; else el.textContent = val;
    });

    // ensure option text updated (for some browsers)
    ['layout.monthly','layout.year1','week.sun','week.mon'].forEach(k=>{
      const el = document.querySelector(`[data-i18n="${k}"]`);
      if (el){ const v = get(D,k); if (v!=null) el.textContent = v; }
    });
  }

  function keepLangInLinks(lang){
    document.querySelectorAll('a[href]').forEach(a=>{
      const href = a.getAttribute('href')||'';
      if (!href || href.startsWith('#') || href.startsWith('http') || href.startsWith('mailto:') || href.startsWith('tel:')) return;
      const u = new URL(href, location.origin);
      if (!u.searchParams.get('lang')) u.searchParams.set('lang', lang);
      a.setAttribute('href', u.pathname + u.search + u.hash);
    });
  }

  // ------- UI wiring -------
  function generate(){
    const lang = window.__LANG__ || 'en';
    const dict = window.__DICT__ || EN;

    const y = parseInt(yearEl.value, 10) || new Date().getFullYear();
    const layout = layoutEl.value;
    const ws = parseInt(weekStartEl.value, 10);
    const showWeek = weekNumEl.checked;

    renderPreview(y, ws, showWeek, lang);
    renderPrint(y, layout, ws, showWeek, lang, dict);

    const qs = new URLSearchParams(location.search);
    qs.set('y', y); qs.set('l', layout); qs.set('ws', ws); qs.set('wk', showWeek?1:0);
    if (lang) qs.set('lang', lang);
    history.replaceState({}, '', location.pathname + '?' + qs.toString());
  }

  document.querySelectorAll('.chip[data-year]').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      yearEl.value = ch.dataset.year;
      generate();
    });
  });

  document.getElementById('genBtn').addEventListener('click', generate);
  document.getElementById('printBtn').addEventListener('click', ()=>{
    printRoot.style.display = 'block';
    window.print();
    setTimeout(()=>{ printRoot.style.display = 'none'; }, 300);
  });

  // ------- boot: language then state -------
  (function boot(){
    const lang = pickLang();
    const D = merge(EN, MAP[lang]||{});
    window.__LANG__ = lang;
    window.__DICT__ = D;

    applyI18N(D);
    keepLangInLinks(lang);

    const q = new URLSearchParams(location.search);
    if (q.has('y')) yearEl.value = q.get('y');
    if (q.has('l')) layoutEl.value = q.get('l');
    if (q.has('ws')) weekStartEl.value = q.get('ws');
    if (q.has('wk')) weekNumEl.checked = q.get('wk') === '1';
    generate();

    // build lang panel
    const panel = document.getElementById('langPanel');
    const btn = document.getElementById('langBtn');
    const grid = document.getElementById('langGrid');
    if (grid){
      ['en','zh','ph','id','vi','bn','ng','sw','ar'].forEach(code=>{
        const b=document.createElement('button');
        b.textContent = NAMES[code]||code;
        if (code===lang) b.className='active';
        b.addEventListener('click', ()=>{
          const u=new URL(location.href);
          u.searchParams.set('lang', code);
          setCookie('lang', code);
          location.href=u.toString();
        });
        grid.appendChild(b);
      });
    }
    function openLang(open){ panel.classList.toggle('open', !!open); btn.setAttribute('aria-expanded', !!open); }
    if (btn) btn.addEventListener('click', (e)=>{ e.stopPropagation(); openLang(!panel.classList.contains('open')); });
    document.addEventListener('click', (e)=>{ if(panel && panel.classList.contains('open')){ const within = panel.contains(e.target) || (btn && btn.contains(e.target)); if(!within) openLang(false); } });
  })();
</script>

<!-- Back-to-home resolver (preserve ?lang) -->
<script>
(function(){
  var path = location.pathname.replace(/\/+$/,''); // strip trailing slashes
  var parts = path.split('/');
  if (parts.length >= 3) parts = parts.slice(0, parts.length - 2);
  else parts = ['']; // already at root
  var home = parts.join('/') + '/';

  // preserve ?lang if present
  var cur = new URL(location.href);
  var lang = cur.searchParams.get('lang');
  if (lang) {
    var u = new URL(home, location.origin);
    u.searchParams.set('lang', lang);
    home = u.pathname + u.search + u.hash;
  }

  document.querySelectorAll('a[data-home]').forEach(function(a){
    a.setAttribute('href', home);
  });
})();
</script>
</body>
</html>
