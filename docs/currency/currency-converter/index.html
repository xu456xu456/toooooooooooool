<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Free Currency Converter â€” Offline-First + Live Rates (Multi-Source) | GoToolOnline</title>
<meta name="description" content="Fast, free currency converter. Works offline with a manual rate and supports live exchange rates from multiple sources for reliability. Convert USD, EUR, GBP, AUD, JPY, CNY and more."/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="robots" content="index,follow,max-image-preview:large"/>
<meta name="theme-color" content="#0a0f1e"/>

<meta property="og:type" content="website"/>
<meta property="og:title" content="Free Currency Converter â€” Offline-First + Live Rates (Multi-Source)"/>
<meta property="og:description" content="Convert currencies offline with a manual rate or fetch live multi-source rates. USD â‡„ EUR, GBP, AUD, JPY, CNY and more."/>
<meta property="og:url" content="https://gotoolonline.com/currency/currency-converter/"/>
<meta property="og:site_name" content="GoToolOnline"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Free Currency Converter â€” Offline-First + Live Rates (Multi-Source)"/>
<meta name="twitter:description" content="Works offline + live multi-source rates. USD, EUR, GBP, AUD, JPY, CNY and more."/>
<link rel="icon" href="data:image/svg+xml,&lt;svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'&gt;&lt;text x='6' y='52' font-size='48'&gt;ğŸ› ï¸&lt;/text&gt;&lt;/svg&gt;"/>
<link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/><link rel="dns-prefetch" href="https://fonts.gstatic.com"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&amp;display=swap"/>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebApplication","name":"Currency Converter","url":"https://gotoolonline.com/currency/currency-converter/","applicationCategory":"FinancialApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"publisher":{"@type":"Organization","name":"GoToolOnline","url":"https://gotoolonline.com"}}
</script>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[
{"@type":"Question","name":"Does it work offline?","acceptedAnswer":{"@type":"Answer","text":"Yes. Enter a manual rate to convert offline. When online, you can fetch live rates from multiple sources (e.g., open.er-api.com and exchangerate.host) for reliability."}},
{"@type":"Question","name":"Which currencies are supported?","acceptedAnswer":{"@type":"Answer","text":"Popular currencies like USD, EUR, GBP, AUD, NZD, CAD, JPY, CNY, HKD, INR, SGD, KRW, THB, PHP, MYR, IDR, CHF, SEK, NOK, DKK, ZAR, BRL, MXN and more."}},
{"@type":"Question","name":"Why is my bank rate different?","acceptedAnswer":{"@type":"Answer","text":"Retail bank rates often include fees/spread and can differ from public mid-market quotes. For reconciliation, fix a manual rate and reuse it."}},
{"@type":"Question","name":"How to share a pre-filled link?","acceptedAnswer":{"@type":"Answer","text":"Use URL parameters: ?amount=100&from=USD&to=EUR&rate=0.93 then share the link."}}
]}
</script>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[
{"@type":"ListItem","position":1,"name":"Home","item":"https://gotoolonline.com/"},
{"@type":"ListItem","position":2,"name":"Currency Tools","item":"https://gotoolonline.com/#currency"},
{"@type":"ListItem","position":3,"name":"Currency Converter","item":"https://gotoolonline.com/currency/currency-converter/"}
]}
</script>
<style>
  :root { --bg:#0a0f1e; --card:#0f1830; --muted:#9fb0c3; --fg:#eaf3ff; --acc:#4fb3ff; }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg);}
  header{max-width:1200px;margin:24px auto 8px;display:flex;gap:14px;align-items:center;padding:0 18px;}
  header a.logo{display:flex;gap:10px;align-items:center;text-decoration:none;color:var(--fg);font-weight:800;font-size:24px}
  header a.navbtn{margin-left:auto;padding:10px 14px;background:#0f1a2f;border:1px solid #24365b;border-radius:12px;color:#eaf3ff;text-decoration:none;font-size:16px}
  header a.navbtn:hover{border-color:#4fb3ff;box-shadow:0 0 0 3px rgba(79,179,255,.18)}
  .pill{padding:8px 12px;border:1px solid #24365b;background:#0f1a2f;border-radius:999px;color:#eaf3ff}
  #langBtn{margin-left:8px}
  .lang-panel{position:fixed; top:72px; right:18px; z-index:1000;background:#0f1830;border:1px solid #1a2843;border-radius:16px;padding:12px;display:none;width:min(420px,calc(100vw - 24px));box-shadow:0 20px 60px rgba(0,0,0,.45)}
  .lang-panel.open{display:block}
  .lang-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
  .lang-grid button{display:block;width:100%;text-align:center;padding:10px;border:1px solid #24365b;background:#0f1a2f;border-radius:12px;color:#eaf3ff;font-size:14px;cursor:pointer}
  .lang-grid button.active{border-color:#4fb3ff;box-shadow:0 0 0 3px rgba(79,179,255,.18)}
  main{max-width:1200px;margin:10px auto 64px;padding:0 18px}
  h1{font-size:34px;margin:10px 0 10px}
  h2{font-size:22px;margin:14px 0 6px}
  p,label,.muted{font-size:18px; line-height:1.6}
  .card{background:var(--card);border:1px solid #1a2843;border-radius:20px;padding:20px;margin:16px 0}
  label{display:block;margin:10px 0 6px;color:var(--muted)}
  input,select,button,textarea{width:100%;padding:14px;border-radius:12px;border:1px solid #24365b;background:#0f1a2f;color:#eaf3ff;font-size:18px}
  button{cursor:pointer;background:linear-gradient(180deg,#2a78ff,#0050d4);border:none;font-weight:700;letter-spacing:.2px}
  button:hover{filter:brightness(1.06)}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  .toolbar{display:flex;gap:12px;flex-wrap:wrap}
  .result{padding:14px;background:#0c1426;border:1px dashed #2a3c64;border-radius:12px;margin-top:12px;font-size:20px}
  .muted{color:#9fb0c3}
  .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .chip{padding:8px 12px;border:1px solid #24365b;background:#0f1a2f;border-radius:999px;cursor:pointer;font-size:16px}
  .chip:hover{border-color:#4fb3ff;box-shadow:0 0 0 3px rgba(79,179,255,.18)}
  footer{max-width:1200px;margin:40px auto;padding:0 18px;color:#9fb0c3;font-size:15px}
  .backTop{margin-top:12px;display:inline-block;padding:10px 14px;background:#0f1a2f;border:1px solid #24365b;border-radius:10px;color:#eaf3ff;text-decoration:none}
  .backTop:hover{border-color:#4fb3ff;box-shadow:0 0 0 3px rgba(79,179,255,.18)}
  @media (max-width:760px){ .row{grid-template-columns:1fr} .toolbar{gap:10px} }
  @media print{ header,footer,.no-print{display:none!important} body{background:#fff;color:#000} .card{border:none} }
</style>

  
  <link rel="alternate" hreflang="en" href="https://gotoolonline.com/currency/currency-converter/"/>
  <link rel="alternate" hreflang="x-default" href="https://gotoolonline.com/currency/currency-converter/"/>

<link rel="canonical" href="https://gotoolonline.com/currency/currency-converter/">
</head>
<body>
<header>
  <a aria-label="GoToolOnline home" class="logo" data-home href="#"><span>ğŸ› ï¸</span><strong>GoToolOnline</strong></a>
  <a aria-label="Back to Home" class="navbtn" data-home href="#" data-i18n="ui.back">â† Back to Home</a>
  <button id="langBtn" class="pill" aria-haspopup="dialog" aria-expanded="false" data-i18n="ui.lang">ğŸŒ Language</button>
  <div class="lang-panel" id="langPanel" role="dialog" aria-label="Select language">
    <div class="lang-grid" id="langGrid"></div>
  </div>
</header>

<main>
<section class="card">
  <h1 data-i18n="title">Currency Converter</h1>
  <p class="muted" data-i18n="lede">Free, offline-first currency converter. If live rates are blocked, enter a <strong>manual rate</strong>; otherwise click <strong>Try Live Rate</strong> for multi-source updates. Popular: <em>USD to EUR</em>, <em>USD to CNY</em>, <em>EUR to GBP</em>, <em>USD to AUD</em>.</p>

  <div class="row" role="group" aria-label="Amount and manual rate">
    <div><label for="amount" data-i18n="form.amount">Amount</label><input id="amount" inputmode="decimal" step="0.01" type="number" value="1"/></div>
    <div><label for="manual" data-i18n="form.manual">Manual rate (optional)</label><input id="manual" inputmode="decimal" placeholder="e.g. 0.7365" step="0.000001" type="number"/></div>
  </div>

  <div class="row" role="group" aria-label="Currency selection">
    <div>
      <label for="from" data-i18n="form.from">From</label>
      <select id="from" autocomplete="off"></select>
    </div>
    <div>
      <label for="to" data-i18n="form.to">To</label>
      <select id="to" autocomplete="off"></select>
    </div>
  </div>

  <div class="toolbar" style="margin-top:10px">
    <button id="swap" style="width:auto;padding:14px 18px" data-i18n="btn.swap">â‡„ Swap</button>
    <button id="btnConvert" data-i18n="btn.convertManual">Convert (Manual / Provided)</button>
    <button id="btnLive" data-i18n="btn.tryLive">Try Live Rate</button>
    <button id="btnCopy" class="pill" style="background:#0f1a2f" data-i18n="btn.copy">Copy Result</button>
  </div>

  <div id="fx" class="result" role="status" aria-live="polite">â€”</div>
  <p class="muted" id="note"></p>

  <h2 data-i18n="popular">Popular conversions</h2>
  <div class="chips" id="chips">
    <span class="chip" data-a="USD" data-b="EUR">USD â†’ EUR</span>
    <span class="chip" data-a="EUR" data-b="USD">EUR â†’ USD</span>
    <span class="chip" data-a="USD" data-b="GBP">USD â†’ GBP</span>
    <span class="chip" data-a="USD" data-b="JPY">USD â†’ JPY</span>
    <span class="chip" data-a="USD" data-b="CNY">USD â†’ CNY</span>
    <span class="chip" data-a="USD" data-b="AUD">USD â†’ AUD</span>
    <span class="chip" data-a="USD" data-b="CAD">USD â†’ CAD</span>
    <span class="chip" data-a="USD" data-b="INR">USD â†’ INR</span>
    <span class="chip" data-a="EUR" data-b="GBP">EUR â†’ GBP</span>
    <span class="chip" data-a="EUR" data-b="JPY">EUR â†’ JPY</span>
    <span class="chip" data-a="EUR" data-b="CNY">EUR â†’ CNY</span>
    <span class="chip" data-a="EUR" data-b="CHF">EUR â†’ CHF</span>
    <span class="chip" data-a="GBP" data-b="USD">GBP â†’ USD</span>
    <span class="chip" data-a="GBP" data-b="EUR">GBP â†’ EUR</span>
    <span class="chip" data-a="GBP" data-b="JPY">GBP â†’ JPY</span>
    <span class="chip" data-a="AUD" data-b="NZD">AUD â†’ NZD</span>
    <span class="chip" data-a="AUD" data-b="USD">AUD â†’ USD</span>
    <span class="chip" data-a="JPY" data-b="USD">JPY â†’ USD</span>
    <span class="chip" data-a="CNY" data-b="USD">CNY â†’ USD</span>
    <span class="chip" data-a="SGD" data-b="USD">SGD â†’ USD</span>
    <span class="chip" data-a="USD" data-b="MXN">USD â†’ MXN</span>
    <span class="chip" data-a="USD" data-b="BRL">USD â†’ BRL</span>
    <span class="chip" data-a="USD" data-b="ZAR">USD â†’ ZAR</span>
  </div>

  <h2 data-i18n="how.title">How to use</h2>
  <p class="muted" data-i18n="how.text">Type the amount, pick currencies, then either paste a <em>manual rate</em> (works offline) or use <em>Try Live Rate</em>. Results are shown instantly. For travel or budgeting, you can save a snapshot rate and reuse it anytime.</p>

  <h2 data-i18n="faq.title">Tips &amp; FAQs</h2>
  <p class="muted" data-i18n="faq.q1"><strong>Why is my bank rate different?</strong> Retail rates include fees/spread and differ from public mid-market quotes. For reconciliation, fix a manual rate and reuse it.</p>
  <p class="muted" data-i18n="faq.q2"><strong>How often do rates update?</strong> Public APIs typically refresh every minutes to hourly; during volatile periods, consider fixing a reference rate.</p>
  <p class="muted" data-i18n="faq.q3"><strong>How to share a pre-filled link?</strong> Use <code>?amount=100&amp;from=USD&amp;to=EUR&amp;rate=0.93</code> and share the URL.</p>
  <p class="muted" data-i18n="faq.q4"><strong>Offline use?</strong> When offline, fill <em>Manual rate</em> and convert normally; when online, click â€œTry Live Rateâ€.</p>

  <p class="muted" style="margin-top:10px">
    <span data-i18n="related.title">Related tools:</span>
    <a href="/converter/unit-converter/">Unit Converter</a> Â·
    <a href="/time/timezone-converter/">World Time Converter</a> Â·
    <a href="/time/unix-timestamp/">Unix Timestamp Converter</a>
  </p>
</section>
</main>

<footer>
  <a class="backTop" href="javascript:void(0)" id="backTop" data-i18n="ui.top">Back to Top â†‘</a>
  <div style="margin-top:10px">Â© <span id="yy"></span> GoToolOnline.com Â· Free online tools for everyone.</div>
</footer>

<script>
  // Year & Back to Top
  document.getElementById('yy').textContent = new Date().getFullYear();
  document.getElementById('backTop').onclick = () => window.scrollTo({top:0, behavior:'smooth'});

  // Currency lists (keep populars first)
  const POP = ["USD","EUR","GBP","AUD","NZD","CAD","JPY","CNY","HKD","INR","SGD","KRW","THB","PHP","MYR","IDR","CHF","SEK","NOK","DKK","ZAR","BRL","MXN"];
  const ALL = POP; // extend here if needed

  const fromSel = document.getElementById('from');
  const toSel   = document.getElementById('to');
  function fillCurrencySelects(){
    [fromSel,toSel].forEach(sel=>{
      sel.innerHTML='';
      ALL.forEach(ccy=>{
        const o=document.createElement('option'); o.value=ccy; o.textContent=ccy; sel.appendChild(o);
      });
    });
    if (!fromSel.value) fromSel.value='USD';
    if (!toSel.value) toSel.value='AUD';
  }
  fillCurrencySelects();

  // Format helpers
  function money(v, code){
    try{ return new Intl.NumberFormat(undefined, {style:'currency', currency:code}).format(v); }
    catch{ return (isFinite(v)? v.toFixed(4): 'â€”') + ' ' + code; }
  }
  function rateFmt(r){ return isFinite(r)? r.toFixed(6) : 'â€”'; }

  // Convert: manual or provided rateOverride
  function convert(rateOverride){
    const amt = parseFloat(document.getElementById('amount').value || '0');
    const from = fromSel.value;
    const to = toSel.value;
    const manual = parseFloat(document.getElementById('manual').value);
    const out = document.getElementById('fx');
    const note = document.getElementById('note');
    const D = window.__DICT__ || {};
    const msg = D.msg || {};

    const rate = (typeof rateOverride==='number' && rateOverride>0) ? rateOverride :
                 (!isNaN(manual) && manual>0 ? manual : NaN);

    if (!isFinite(amt) || !from || !to){ out.textContent='â€”'; note.textContent=''; return; }
    if (isNaN(rate)){
      out.textContent = msg.noLiveEnterManual || 'No live rate. Enter a manual rate above, or click â€œTry Live Rateâ€.';
      note.textContent=''; return;
    }

    const converted = amt * rate;
    out.textContent = money(amt, from) + ' = ' + money(converted, to) + '  (rate ' + rateFmt(rate) + ')';
    note.textContent = (typeof rateOverride==='number') ? (msg.liveUsed || 'Rate from live API.') : (msg.manualUsed || 'Manual rate used.');
  }

  // Live fetch with multi-source fallback
  async function tryFetch(){
    const from = fromSel.value;
    const to = toSel.value;
    const out = document.getElementById('fx');
    const note = document.getElementById('note');
    const D = window.__DICT__ || {}; const msg = D.msg || {};

    const sources = [
      async ()=>{ const r=await fetch('https://open.er-api.com/v6/latest/'+from,{cache:'no-store'}); const d=await r.json(); if(d&&d.result==='success'&&d.rates&&d.rates[to]) return d.rates[to]; throw 0; },
      async ()=>{ const r=await fetch('https://api.exchangerate.host/latest?base='+from+'&symbols='+to,{cache:'no-store'}); const d=await r.json(); if(d&&d.rates&&d.rates[to]) return d.rates[to]; throw 0; }
    ];

    for(const s of sources){
      try { const rate = await s(); convert(rate); return; } catch(e){}
    }
    out.textContent = msg.liveBlocked || 'Live rates are blocked by your network. Please enter a manual rate.';
    note.textContent = (msg.tipSearch || 'Tip: Search â€œ{FROM} to {TO}â€ and paste the rate here.').replace('{FROM}', from).replace('{TO}', to);
  }

  // Swap + Copy
  document.getElementById('swap').addEventListener('click', ()=>{
    const tmp = fromSel.value; fromSel.value = toSel.value; toSel.value = tmp; convert();
  });
  document.getElementById('btnCopy').addEventListener('click', ()=>{
    const t = document.getElementById('fx').textContent.trim();
    if (!t || t==='â€”') return;
    const D = window.__DICT__ || { btn:{copied:"Copied!", copy:"Copy Result"} };
    navigator.clipboard?.writeText(t).then(()=>{
      const b=document.getElementById('btnCopy'); b.textContent = D.btn?.copied || "Copied!";
      setTimeout(()=>{ b.textContent = D.btn?.copy || "Copy Result"; }, 900);
    });
  });

  // Buttons
  document.getElementById('btnConvert').addEventListener('click', ()=>convert());
  document.getElementById('btnLive').addEventListener('click', tryFetch);

  // Chips quick action
  document.getElementById('chips').addEventListener('click', (e)=>{
    const t = e.target.closest('.chip'); if(!t) return;
    fromSel.value = t.dataset.a; toSel.value = t.dataset.b;
    tryFetch();
    window.scrollTo({top:0, behavior:'smooth'});
  });

  // URL prefill: ?amount=&from=&to=&rate=
  (function bootFromURL(){
    const q = new URLSearchParams(location.search);
    const amount = q.get('amount'); const from = q.get('from'); const to = q.get('to'); const rate = q.get('rate');
    if (amount) document.getElementById('amount').value = amount;
    if (from && ALL.includes(from.toUpperCase())) fromSel.value = from.toUpperCase();
    if (to   && ALL.includes(to.toUpperCase()))   toSel.value   = to.toUpperCase();
    if (rate) document.getElementById('manual').value = rate;
    convert();
  })();
</script>

<!-- i18n -->
<script>
  const EN = {
    meta:{title:"Free Currency Converter â€” Offline-First + Live Rates (Multi-Source) | GoToolOnline",
          desc:"Fast, free currency converter. Works offline with a manual rate and supports live exchange rates from multiple sources for reliability."},
    ui:{back:"â† Back to Home", lang:"Language", top:"Back to Top â†‘"},
    title:"Currency Converter",
    lede:"Free, offline-first currency converter. If live rates are blocked, enter a <strong>manual rate</strong>; otherwise click <strong>Try Live Rate</strong> for multi-source updates. Popular: <em>USD to EUR</em>, <em>USD to CNY</em>, <em>EUR to GBP</em>, <em>USD to AUD</em>.",
    form:{amount:"Amount", manual:"Manual rate (optional)", from:"From", to:"To"},
    btn:{swap:"â‡„ Swap", convertManual:"Convert (Manual / Provided)", tryLive:"Try Live Rate", copy:"Copy Result", copied:"Copied!"},
    popular:"Popular conversions",
    how:{title:"How to use", text:"Type the amount, pick currencies, then either paste a <em>manual rate</em> (works offline) or use <em>Try Live Rate</em>. Results are shown instantly. For travel or budgeting, you can save a snapshot rate and reuse it anytime."},
    faq:{title:"Tips & FAQs",
      q1:"<strong>Why is my bank rate different?</strong> Retail rates include fees/spread and differ from public mid-market quotes. For reconciliation, fix a manual rate and reuse it.",
      q2:"<strong>How often do rates update?</strong> Public APIs typically refresh every minutes to hourly; during volatile periods, consider fixing a reference rate.",
      q3:"<strong>How to share a pre-filled link?</strong> Use <code>?amount=100&amp;from=USD&amp;to=EUR&amp;rate=0.93</code> and share the URL.",
      q4:"<strong>Offline use?</strong> When offline, fill <em>Manual rate</em> and convert normally; when online, click â€œTry Live Rateâ€."},
    related:{title:"Related tools:"},
    msg:{noLiveEnterManual:"No live rate. Enter a manual rate above, or click â€œTry Live Rateâ€.",
         liveUsed:"Rate from live API.", manualUsed:"Manual rate used.",
         liveBlocked:"Live rates are blocked by your network. Please enter a manual rate.",
         tipSearch:"Tip: Search â€œ{FROM} to {TO}â€ and paste the rate here."}
  };

  const ZH = {
    meta:{title:"å…è´¹æ±‡ç‡è½¬æ¢å™¨ï¼ˆç¦»çº¿ä¼˜å…ˆ + å¤šæºå®æ—¶ï¼‰| GoToolOnline",
          desc:"å¿«é€Ÿã€å…è´¹çš„æ±‡ç‡æ¢ç®—å™¨ã€‚ç¦»çº¿å¯ç”¨æ‰‹åŠ¨æ±‡ç‡ï¼›åœ¨çº¿å¯å°è¯•å¤šæºå®æ—¶æ±‡ç‡ã€‚"},
    ui:{back:"â† è¿”å›é¦–é¡µ", lang:"è¯­è¨€", top:"è¿”å›é¡¶éƒ¨ â†‘"},
    title:"æ±‡ç‡è½¬æ¢å™¨",
    lede:"ç¦»çº¿ä¼˜å…ˆï¼šè‹¥å®æ—¶æ±‡ç‡è¢«é˜»æ­¢ï¼Œå¯è¾“å…¥<strong>æ‰‹åŠ¨æ±‡ç‡</strong>ï¼›å¦åˆ™ç‚¹<strong>å°è¯•å®æ—¶æ±‡ç‡</strong>è·å–å¤šæºæ›´æ–°ã€‚å¸¸ç”¨ï¼š<em>USDâ†’EUR</em>ã€<em>USDâ†’CNY</em>ã€<em>EURâ†’GBP</em>ã€<em>USDâ†’AUD</em>ã€‚",
    form:{amount:"é‡‘é¢", manual:"æ‰‹åŠ¨æ±‡ç‡ï¼ˆå¯é€‰ï¼‰", from:"ä»", to:"åˆ°"},
    btn:{swap:"â‡„ äº¤æ¢", convertManual:"è½¬æ¢ï¼ˆæ‰‹åŠ¨/å·²æä¾›ï¼‰", tryLive:"å°è¯•å®æ—¶æ±‡ç‡", copy:"å¤åˆ¶ç»“æœ", copied:"å·²å¤åˆ¶"},
    popular:"å¸¸ç”¨æ¢ç®—",
    how:{title:"ä½¿ç”¨æ–¹æ³•", text:"è¾“å…¥é‡‘é¢ä¸å¸ç§ï¼Œç²˜è´´<strong>æ‰‹åŠ¨æ±‡ç‡</strong>ï¼ˆå¯ç¦»çº¿ï¼‰ï¼Œæˆ–ç‚¹å‡»<strong>å°è¯•å®æ—¶æ±‡ç‡</strong>ã€‚ç»“æœå³æ—¶æ˜¾ç¤ºï¼›æ—…è¡Œæˆ–åšé¢„ç®—æ—¶å¯ä¿å­˜å¿«ç…§æ±‡ç‡åå¤ä½¿ç”¨ã€‚"},
    faq:{title:"æç¤ºä¸å¸¸è§é—®é¢˜",
      q1:"<strong>é“¶è¡Œæ±‡ç‡ä¸ºä½•ä¸åŒï¼Ÿ</strong> é›¶å”®æ±‡ç‡å«æ‰‹ç»­è´¹/ä»·å·®ï¼Œé€šå¸¸ä¸åŒäºå…¬å¼€ä¸­é—´ä»·ã€‚å¯¹è´¦æ—¶å¯å›ºå®šä¸€æ¡æ‰‹åŠ¨æ±‡ç‡ã€‚",
      q2:"<strong>å¤šä¹…æ›´æ–°ï¼Ÿ</strong> å…¬å…± API ä¸€èˆ¬æ•°åˆ†é’Ÿè‡³æ¯å°æ—¶æ›´æ–°ï¼›æ³¢åŠ¨æœŸå»ºè®®å›ºå®šå‚è€ƒæ±‡ç‡ã€‚",
      q3:"<strong>å¦‚ä½•åˆ†äº«é¢„å¡«é“¾æ¥ï¼Ÿ</strong> ä½¿ç”¨ <code>?amount=100&amp;from=USD&amp;to=EUR&amp;rate=0.93</code>ã€‚",
      q4:"<strong>ç¦»çº¿ï¼Ÿ</strong> ç¦»çº¿æ—¶å¡«â€œæ‰‹åŠ¨æ±‡ç‡â€æ­£å¸¸è½¬æ¢ï¼›åœ¨çº¿æ—¶ç‚¹â€œå°è¯•å®æ—¶æ±‡ç‡â€ã€‚"},
    related:{title:"ç›¸å…³å·¥å…·ï¼š"},
    msg:{noLiveEnterManual:"æš‚æ— å®æ—¶æ±‡ç‡ã€‚è¯·åœ¨ä¸Šæ–¹è¾“å…¥æ‰‹åŠ¨æ±‡ç‡ï¼Œæˆ–ç‚¹å‡»â€œå°è¯•å®æ—¶æ±‡ç‡â€ã€‚",
         liveUsed:"å·²ä½¿ç”¨å®æ—¶æ±‡ç‡ã€‚", manualUsed:"å·²ä½¿ç”¨æ‰‹åŠ¨æ±‡ç‡ã€‚",
         liveBlocked:"ç½‘ç»œé˜»æ­¢äº†å®æ—¶æ±‡ç‡ï¼Œè¯·è¾“å…¥æ‰‹åŠ¨æ±‡ç‡ã€‚",
         tipSearch:"å°æŠ€å·§ï¼šæœç´¢â€œ{FROM} to {TO}â€å¹¶ç²˜è´´è¯¥æ±‡ç‡ã€‚"}
  };

  const PH = {
    ui:{back:"â† Bumalik sa Home", lang:"Wika", top:"Bumalik sa Itaas â†‘"},
    title:"Currency Converter",
    lede:"Offline-first na converter. Kung harang ang live rates, ilagay ang <strong>manual rate</strong>; kung online, i-tap ang <strong>Try Live Rate</strong>.",
    form:{amount:"Halaga", manual:"Manual rate (opsyonal)", from:"Mula", to:"Sa"},
    btn:{swap:"â‡„ Palitan", convertManual:"I-convert (Manual / Provided)", tryLive:"Subukan ang Live Rate", copy:"Kopyahin ang Resulta", copied:"Nakopya!"},
    popular:"Mga madalas na conversion",
    how:{title:"Paano gamitin", text:"Ilagay ang halaga at mga pera, pagkatapos ay manual rate o Try Live Rate."},
    faq:{title:"Tips & FAQs", q1:"", q2:"", q3:"", q4:""},
    related:{title:"Kaugnay na tools:"},
    msg:{noLiveEnterManual:"Walang live rate. Ilagay ang manual rate o i-tap ang â€œTry Live Rateâ€.",
         liveUsed:"Galing sa live API.", manualUsed:"Manual rate ang ginamit.",
         liveBlocked:"Na-block ang live rates. Pakilagay ang manual rate.",
         tipSearch:"Tip: Hanapin â€œ{FROM} to {TO}â€ at i-paste ang rate."}
  };

  const ID = {
    ui:{back:"â† Kembali", lang:"Bahasa", top:"Kembali ke Atas â†‘"},
    title:"Konverter Mata Uang",
    lede:"Offline-first: jika live rate terblokir, masukkan <strong>kurs manual</strong>; bila online, klik <strong>Coba Live Rate</strong>.",
    form:{amount:"Jumlah", manual:"Kurs manual (opsional)", from:"Dari", to:"Ke"},
    btn:{swap:"â‡„ Tukar", convertManual:"Konversi (Manual/Disediakan)", tryLive:"Coba Live Rate", copy:"Salin Hasil", copied:"Tersalin!"},
    popular:"Konversi populer",
    how:{title:"Cara pakai", text:"Isi jumlah & mata uang, lalu kurs manual atau Live Rate."},
    faq:{title:"Tips & FAQ", q1:"", q2:"", q3:"", q4:""},
    related:{title:"Terkait:"},
    msg:{noLiveEnterManual:"Tidak ada live rate. Masukkan kurs manual atau klik â€œCoba Live Rateâ€.",
         liveUsed:"Kurs dari API live.", manualUsed:"Memakai kurs manual.",
         liveBlocked:"Live rate terblokir. Masukkan kurs manual.",
         tipSearch:"Tips: Cari â€œ{FROM} to {TO}â€ lalu tempel kurs."}
  };

  const VI = {
    ui:{back:"â† Vá» trang chá»§", lang:"NgÃ´n ngá»¯", top:"LÃªn Ä‘áº§u trang â†‘"},
    title:"Bá»™ Ä‘á»•i tiá»n tá»‡",
    lede:"Æ¯u tiÃªn ngoáº¡i tuyáº¿n: náº¿u bá»‹ cháº·n, nháº­p <strong>tá»· giÃ¡ thá»§ cÃ´ng</strong>; náº¿u trá»±c tuyáº¿n, báº¥m <strong>Thá»­ tá»· giÃ¡ trá»±c tuyáº¿n</strong>.",
    form:{amount:"Sá»‘ tiá»n", manual:"Tá»· giÃ¡ thá»§ cÃ´ng (tÃ¹y chá»n)", from:"Tá»«", to:"Sang"},
    btn:{swap:"â‡„ Äá»•i", convertManual:"Äá»•i (Thá»§ cÃ´ng/ÄÃ£ cÃ³)", tryLive:"Thá»­ tá»· giÃ¡ trá»±c tuyáº¿n", copy:"Sao chÃ©p káº¿t quáº£", copied:"ÄÃ£ sao chÃ©p!"},
    popular:"Chuyá»ƒn Ä‘á»•i phá»• biáº¿n",
    how:{title:"CÃ¡ch dÃ¹ng", text:"Nháº­p sá»‘ tiá»n & chá»n tiá»n tá»‡, sau Ä‘Ã³ dÃ¡n tá»· giÃ¡ hoáº·c dÃ¹ng Live Rate."},
    faq:{title:"Máº¹o & FAQ", q1:"", q2:"", q3:"", q4:""},
    related:{title:"LiÃªn quan:"},
    msg:{noLiveEnterManual:"ChÆ°a cÃ³ tá»· giÃ¡ trá»±c tuyáº¿n. HÃ£y nháº­p tá»· giÃ¡ thá»§ cÃ´ng hoáº·c báº¥m â€œThá»­ tá»· giÃ¡ trá»±c tuyáº¿nâ€.",
         liveUsed:"DÃ¹ng tá»· giÃ¡ trá»±c tuyáº¿n.", manualUsed:"DÃ¹ng tá»· giÃ¡ thá»§ cÃ´ng.",
         liveBlocked:"Máº¡ng cháº·n tá»· giÃ¡ trá»±c tuyáº¿n. Vui lÃ²ng nháº­p tá»· giÃ¡ thá»§ cÃ´ng.",
         tipSearch:"Máº¹o: tÃ¬m â€œ{FROM} to {TO}â€ rá»“i dÃ¡n tá»· giÃ¡."}
  };

  const BN = {
    ui:{back:"â† à¦¹à§‹à¦®à§‡ à¦«à¦¿à¦°à§‡", lang:"à¦­à¦¾à¦·à¦¾", top:"à¦‰à¦ªà¦°à§‡ à¦¯à¦¾à¦¨ â†‘"},
    title:"à¦•à¦¾à¦°à§‡à¦¨à§à¦¸à¦¿ à¦•à¦¨à¦­à¦¾à¦°à§à¦Ÿà¦¾à¦°",
    lede:"à¦…à¦«à¦²à¦¾à¦‡à¦¨-à¦«à¦¾à¦°à§à¦¸à§à¦Ÿ: à¦²à¦¾à¦‡à¦­ à¦°à§‡à¦Ÿ à¦¨à¦¾ à¦ªà§‡à¦²à§‡ <strong>à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦² à¦°à§‡à¦Ÿ</strong> à¦¦à¦¿à¦¨; à¦…à¦¨à¦²à¦¾à¦‡à¦¨à§‡ à¦¹à¦²à§‡ <strong>Try Live Rate</strong>à¥¤",
    form:{amount:"à¦ªà¦°à¦¿à¦®à¦¾à¦£", manual:"à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦² à¦°à§‡à¦Ÿ (à¦à¦šà§à¦›à¦¿à¦•)", from:"à¦¥à§‡à¦•à§‡", to:"à¦¤à§‡"},
    btn:{swap:"â‡„ à¦…à¦¦à¦²à¦¬à¦¦à¦²", convertManual:"à¦•à¦¨à¦­à¦¾à¦°à§à¦Ÿ (à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦²/à¦ªà§à¦°à¦¦à¦¤à§à¦¤)", tryLive:"à¦²à¦¾à¦‡à¦­ à¦°à§‡à¦Ÿ à¦¨à¦¿à¦¨", copy:"à¦«à¦² à¦•à¦ªà¦¿ à¦•à¦°à§à¦¨", copied:"à¦•à¦ªà¦¿ à¦¹à§Ÿà§‡à¦›à§‡!"},
    popular:"à¦œà¦¨à¦ªà§à¦°à¦¿à§Ÿ à¦•à¦¨à¦­à¦¾à¦°à§à¦¸à¦¨",
    how:{title:"à¦•à§€à¦­à¦¾à¦¬à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‡à¦¨", text:"à¦ªà¦°à¦¿à¦®à¦¾à¦£ à¦“ à¦•à¦¾à¦°à§‡à¦¨à§à¦¸à¦¿ à¦¬à¦¾à¦›à§à¦¨, à¦¤à¦¾à¦°à¦ªà¦° à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦² à¦°à§‡à¦Ÿ à¦¬à¦¾ à¦²à¦¾à¦‡à¦­ à¦°à§‡à¦Ÿà¥¤"},
    faq:{title:"à¦Ÿà¦¿à¦ªà¦¸ à¦“ à¦ªà§à¦°à¦¶à§à¦¨", q1:"", q2:"", q3:"", q4:""},
    related:{title:"à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦Ÿà§à¦²à¦¸:"},
    msg:{noLiveEnterManual:"à¦²à¦¾à¦‡à¦­ à¦°à§‡à¦Ÿ à¦¨à§‡à¦‡à¥¤ à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦² à¦°à§‡à¦Ÿ à¦¦à¦¿à¦¨ à¦¬à¦¾ â€œTry Live Rateâ€ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤",
         liveUsed:"à¦²à¦¾à¦‡à¦­ API à¦°à§‡à¦Ÿ à¦¬à§à¦¯à¦¬à¦¹à§ƒà¦¤à¥¤", manualUsed:"à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦² à¦°à§‡à¦Ÿ à¦¬à§à¦¯à¦¬à¦¹à§ƒà¦¤à¥¤",
         liveBlocked:"à¦²à¦¾à¦‡à¦­ à¦°à§‡à¦Ÿ à¦¬à§à¦²à¦•à¦¡à¥¤ à¦…à¦¨à§à¦—à§à¦°à¦¹ à¦•à¦°à§‡ à¦®à§à¦¯à¦¾à¦¨à§à§Ÿà¦¾à¦² à¦°à§‡à¦Ÿ à¦¦à¦¿à¦¨à¥¤",
         tipSearch:"à¦Ÿà¦¿à¦ª: â€œ{FROM} to {TO}â€ à¦–à§à¦à¦œà§‡ à¦°à§‡à¦Ÿ à¦ªà§‡à¦¸à§à¦Ÿ à¦•à¦°à§à¦¨à¥¤"}
  };

  const NG = {...EN}; // English (NG)

  const SW = {
    ui:{back:"â† Rudi nyumbani", lang:"Lugha", top:"Rudi Juu â†‘"},
    title:"Kigeuzi cha Sarafu",
    lede:"Kipaumbele nje ya mtandao: kama viwango vya moja kwa moja vimezuiliwa, weka <strong>kiasi cha mkono</strong>; ukipata mtandao, bonyeza <strong>Try Live Rate</strong>.",
    form:{amount:"Kiasi", manual:"Kiwango cha mkono (hiari)", from:"Kutoka", to:"Kwenda"},
    btn:{swap:"â‡„ Badilisha", convertManual:"Badilisha (Manual / Zilizopo)", tryLive:"Jaribu Live Rate", copy:"Nakili Matokeo", copied:"Imenakiliwa!"},
    popular:"Mabadilisho maarufu",
    how:{title:"Jinsi ya kutumia", text:"Weka kiasi na sarafu, kisha kiwango cha mkono au Live Rate."},
    faq:{title:"Vidokezo & Maswali", q1:"", q2:"", q3:"", q4:""},
    related:{title:"Vyombo vinavyohusiana:"},
    msg:{noLiveEnterManual:"Hakuna live rate. Weka kiwango cha mkono au bonyeza â€œTry Live Rateâ€.",
         liveUsed:"Kiwango kutoka API ya moja kwa moja.", manualUsed:"Imetumia kiwango cha mkono.",
         liveBlocked:"Mtandao umezuia live rates. Tafadhali weka kiwango cha mkono.",
         tipSearch:"Dokezo: Tafuta â€œ{FROM} to {TO}â€ kisha bandika kiwango."}
  };

  const AR = {
    meta:{title:"Ù…Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª â€” Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„ Ø£ÙˆÙ„Ø§Ù‹ + Ø£Ø³Ø¹Ø§Ø± Ù…Ø¨Ø§Ø´Ø±Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù…ØµØ§Ø¯Ø± | GoToolOnline",
          desc:"Ù…Ø­ÙˆÙ„ Ø³Ø±ÙŠØ¹ ÙˆÙ…Ø¬Ø§Ù†ÙŠ. ÙŠØ¹Ù…Ù„ Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„ Ø¨Ù…Ø¹Ø¯Ù„ ÙŠØ¯ÙˆÙŠØŒ ÙˆÙŠØ¯Ø¹Ù… Ø£Ø³Ø¹Ø§Ø± ØµØ±Ù Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø¹Ø¯Ø© Ù…ØµØ§Ø¯Ø±."},
    ui:{back:"â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", lang:"Ø§Ù„Ù„ØºØ©", top:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰ â†‘"},
    title:"Ù…Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª",
    lede:"Ø£ÙˆÙ„ÙˆÙŠØ© Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„: Ø¥Ù† ÙƒØ§Ù†Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ø­Ø¬ÙˆØ¨Ø©ØŒ Ø£Ø¯Ø®Ù„ <strong>Ø³Ø¹Ø±Ø§Ù‹ ÙŠØ¯ÙˆÙŠØ§Ù‹</strong>Ø› ÙˆØ¥Ù„Ø§ ÙØ§Ù†Ù‚Ø± <strong>ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</strong> Ù„ØªØ­Ø¯ÙŠØ« Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¯Ø±.",
    form:{amount:"Ø§Ù„Ù…Ø¨Ù„Øº", manual:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙŠØ¯ÙˆÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)", from:"Ù…Ù†", to:"Ø¥Ù„Ù‰"},
    btn:{swap:"â‡„ ØªØ¨Ø¯ÙŠÙ„", convertManual:"ØªØ­ÙˆÙŠÙ„ (ÙŠØ¯ÙˆÙŠ/Ù…Ù‚Ø¯Ù…)", tryLive:"ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±", copy:"Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©", copied:"ØªÙ… Ø§Ù„Ù†Ø³Ø®!"},
    popular:"ØªØ­ÙˆÙŠÙ„Ø§Øª Ø´Ø§Ø¦Ø¹Ø©",
    how:{title:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…", text:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº ÙˆØ§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø§ØªØŒ Ø«Ù… Ø£Ù„ØµÙ‚ Ø³Ø¹Ø±Ø§Ù‹ ÙŠØ¯ÙˆÙŠØ§Ù‹ (Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„) Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±."},
    faq:{title:"Ù†ØµØ§Ø¦Ø­ ÙˆØ£Ø³Ø¦Ù„Ø© Ø´Ø§Ø¦Ø¹Ø©", q1:"", q2:"", q3:"", q4:""},
    related:{title:"Ø£Ø¯ÙˆØ§Øª Ø°Ø§Øª ØµÙ„Ø©:"},
    msg:{noLiveEnterManual:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¹Ø± Ù…Ø¨Ø§Ø´Ø±. Ø£Ø¯Ø®Ù„ Ø³Ø¹Ø±Ø§Ù‹ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£Ùˆ Ø§Ù†Ù‚Ø± â€œØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±â€.",
         liveUsed:"Ø§Ù„Ø³Ø¹Ø± Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© Ù…Ø¨Ø§Ø´Ø±Ø©.", manualUsed:"ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙŠØ¯ÙˆÙŠ.",
         liveBlocked:"ØªÙ… Ø­Ø¬Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¹Ø± ÙŠØ¯ÙˆÙŠ.",
         tipSearch:"Ù†ØµÙŠØ­Ø©: Ø§Ø¨Ø­Ø« â€œ{FROM} to {TO}â€ Ø«Ù… Ø§Ù„ØµÙ‚ Ø§Ù„Ø³Ø¹Ø± Ù‡Ù†Ø§."}
  };

  const MAP = {en:EN, zh:ZH, ph:PH, id:ID, vi:VI, bn:BN, ng:NG, sw:SW, ar:AR};
  const LANGS = ['en','zh','ph','id','vi','bn','ng','sw','ar'];
  const NAMES = {en:'English', zh:'ç®€ä½“ä¸­æ–‡', ph:'Tagalog', id:'Bahasa Indonesia', vi:'Tiáº¿ng Viá»‡t', bn:'à¦¬à¦¾à¦‚à¦²à¦¾', ng:'English (NG)', sw:'Kiswahili', ar:'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'};

  function getCookie(name){ return ('; '+document.cookie).split('; '+name+'=').pop().split(';')[0] || ''; }
  function setCookie(name,val){ document.cookie = name+'='+val+';path=/;max-age=31536000'; }
  function get(obj, path){ return String(path).split('.').reduce((o,k)=> (o && (k in o))? o[k] : undefined, obj); }
  function merge(base, over){ const out={...base}; if(!over) return out; for(const k in over){ if(typeof over[k]==='object' && !Array.isArray(over[k])) out[k]=merge(base[k]||{},over[k]); else out[k]=over[k]; } return out; }

  function pickLang(){
    const url = new URL(location.href);
    const q = (url.searchParams.get('lang')||'').toLowerCase();
    const c = (getCookie('lang')||'').toLowerCase();
    const nav = (navigator.language||'en').toLowerCase();
    const MAPG = {en:'en', tl:'ph', fil:'ph', id:'id', vi:'vi', bn:'bn', sw:'sw', ar:'ar', zh:'zh', 'zh-cn':'zh', 'zh-hans':'zh'};
    let lang='en';
    if (q && LANGS.includes(q)) lang=q;
    else if (c && LANGS.includes(c)) lang=c;
    else lang = MAPG[nav] || MAPG[nav.split('-')[0]] || 'en';
    setCookie('lang', lang);
    document.documentElement.lang = (lang==='ph'?'tl':(lang==='ng'?'en':lang));
    document.documentElement.dir = (lang==='ar'?'rtl':'ltr');
    return lang;
  }

  function applyI18N(D){
    if (get(D,'meta.title')) document.title = get(D,'meta.title');
    const desc = document.querySelector('meta[name="description"]');
    if (desc && get(D,'meta.desc')) desc.setAttribute('content', get(D,'meta.desc'));

    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      const val = get(D, key);
      if (val == null) return;
      if (/<[a-z][\s\S]*>/i.test(val)) el.innerHTML = val; else el.textContent = val;
    });
  }

  function keepLangInLinks(lang){
    document.querySelectorAll('a[href]').forEach(a=>{
      const href = a.getAttribute('href')||'';
      if (!href || href.startsWith('#') || href.startsWith('http') || href.startsWith('mailto:') || href.startsWith('tel:')) return;
      const u = new URL(href, location.origin);
      if (!u.searchParams.get('lang')) u.searchParams.set('lang', lang);
      a.setAttribute('href', u.pathname + u.search + u.hash);
    });
  }

  // Build currency selects after i18n init (done already) and boot lang UI
  (function initI18N(){
    const lang = pickLang();
    const D = merge(EN, MAP[lang]||{});
    window.__LANG__ = lang;
    window.__DICT__ = D;
    applyI18N(D);
    keepLangInLinks(lang);

    // Language panel
    const panel = document.getElementById('langPanel');
    const btn = document.getElementById('langBtn');
    const grid = document.getElementById('langGrid');
    LANGS.forEach(code=>{
      const b=document.createElement('button');
      b.textContent = NAMES[code]||code;
      if (code===lang) b.className='active';
      b.addEventListener('click', ()=>{
        const u=new URL(location.href);
        u.searchParams.set('lang', code);
        setCookie('lang', code);
        location.href=u.toString();
      });
      grid.appendChild(b);
    });
    function openLang(open){ panel.classList.toggle('open', !!open); btn.setAttribute('aria-expanded', !!open); }
    if (btn) btn.addEventListener('click', (e)=>{ e.stopPropagation(); openLang(!panel.classList.contains('open')); });
    document.addEventListener('click', (e)=>{ if(panel && panel.classList.contains('open')){ const within = panel.contains(e.target) || (btn && btn.contains(e.target)); if(!within) openLang(false); } });
  })();
</script>

<!-- Preserve ?lang on home links -->
<script>
(function(){
  var path = location.pathname.replace(/\/+$/,'');
  var parts = path.split('/');
  if (parts.length >= 3) parts = parts.slice(0, parts.length - 2);
  else parts = [''];
  var home = parts.join('/') + '/';

  var cur = new URL(location.href);
  var lang = cur.searchParams.get('lang');
  if (lang) {
    var u = new URL(home, location.origin);
    u.searchParams.set('lang', lang);
    home = u.pathname + u.search + u.hash;
  }
  document.querySelectorAll('a[data-home]').forEach(function(a){
    a.setAttribute('href', home);
  });
})();
</script>
</body>
</html>
